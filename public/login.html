<!DOCTYPE html>
<html>
<head>
  <title>Pigeon System Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:Arial;text-align:center;background:#eef2f7;padding-top:60px;}
    input{padding:12px;margin:10px;font-size:16px;width:260px;}
    button{padding:12px 18px;font-size:16px;cursor:pointer;}
    .card{display:inline-block;background:white;padding:24px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.1);}
  </style>
</head>
<body>

  <div class="card">
    <h2>Login</h2>
    <input id="username" placeholder="Username"><br>
    <input id="password" placeholder="Password / PIN" type="password"><br>
    <button type="button" onclick="login()">Login</button>
  </div>

<script>
async function login(){
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();

  if(!username || !password) return alert("Enter username and password/PIN");

  try{
    const res = await fetch("/login",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      credentials:"include",
      body: JSON.stringify({ username, password })
    });

    const data = await res.json();

    if(data.status === "ok"){
      if(data.role === "manager"){
        window.location = "/manager";
      } else {
        window.location = "/worker";
      }
    } else {
      alert("Invalid login");
    }
  }catch(e){
    console.log(e);
    alert("Server not reachable");
  }
}
</script>
</body>
</html>
